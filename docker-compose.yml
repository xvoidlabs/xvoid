version: '3.8'

services:
  coordinator:
    build:
      context: .
      dockerfile: docker/coordinator.Dockerfile
    container_name: xvoid-coordinator
    ports:
      - "3001:3001"
    environment:
      - PORT=3001
      - SOLANA_RPC_URL=${SOLANA_RPC_URL:-https://api.mainnet-beta.solana.com}
      - XVOID_ENTRY_WALLET_SECRET_KEY=${XVOID_ENTRY_WALLET_SECRET_KEY}
    restart: unless-stopped
    networks:
      - xvoid-network

  node:
    build:
      context: .
      dockerfile: docker/node.Dockerfile
    container_name: xvoid-node
    environment:
      - XVOID_NODE_ID=${XVOID_NODE_ID:-node-1}
      - XVOID_COORDINATOR_URL=http://coordinator:3001
      - XVOID_SOLANA_RPC_URL=${SOLANA_RPC_URL:-https://api.mainnet-beta.solana.com}
      - XVOID_NODE_HOT_WALLET_SECRET_KEY=${XVOID_NODE_HOT_WALLET_SECRET_KEY}
      - XVOID_NODE_CAPACITY=${XVOID_NODE_CAPACITY:-10}
    depends_on:
      - coordinator
    restart: unless-stopped
    networks:
      - xvoid-network

  web-ui:
    build:
      context: .
      dockerfile: docker/web-ui.Dockerfile
    container_name: xvoid-web-ui
    ports:
      - "3000:3000"
    environment:
      - NEXT_PUBLIC_COORDINATOR_URL=http://localhost:3001
      - NEXT_PUBLIC_SOLANA_RPC_URL=${SOLANA_RPC_URL:-https://api.mainnet-beta.solana.com}
    depends_on:
      - coordinator
    restart: unless-stopped
    networks:
      - xvoid-network

networks:
  xvoid-network:
    driver: bridge

